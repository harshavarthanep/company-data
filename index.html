<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMO Corporate Analyzer | H24 Creationz</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        corp: { 50: '#f8fafc', 100: '#f1f5f9', 800: '#1e293b', 900: '#0f172a' },
                        accent: { 500: '#3b82f6', 600: '#2563eb' }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #f8fafc; color: #1e293b; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid #e2e8f0; }
        .sidebar-link { transition: all 0.2s; }
        .sidebar-link:hover, .sidebar-link.active { background-color: #f1f5f9; color: #2563eb; border-right: 3px solid #2563eb; }
        input, textarea, select { transition: border 0.2s; }
        input:focus, textarea:focus, select:focus { outline: none; border-color: #3b82f6; ring: 2px; }
        .hide { display: none; }
        
        /* Print/Export Styles */
        @media print {
            .no-print { display: none; }
            .print-only { display: block; }
        }
    </style>
</head>
<body class="h-screen flex overflow-hidden">

    <aside class="w-64 bg-white border-r border-gray-200 flex flex-col justify-between z-10 shadow-sm">
        <div>
            <div class="p-6">
                <h1 class="text-xl font-bold tracking-tight text-corp-900">PMO<span class="text-accent-600">Analyzer</span></h1>
                <p class="text-xs text-gray-400 mt-1">Corporate Intelligence Suite</p>
            </div>
            <nav class="mt-6">
                <a onclick="showTab('dashboard')" id="nav-dashboard" class="sidebar-link active flex items-center px-6 py-3 text-sm font-medium cursor-pointer text-gray-600">
                    <span class="mr-3">üìä</span> Dashboard
                </a>
                <a onclick="showTab('analyze')" id="nav-analyze" class="sidebar-link flex items-center px-6 py-3 text-sm font-medium cursor-pointer text-gray-600">
                    <span class="mr-3">üîç</span> New Analysis
                </a>
                <a onclick="showTab('visualize')" id="nav-visualize" class="sidebar-link flex items-center px-6 py-3 text-sm font-medium cursor-pointer text-gray-600">
                    <span class="mr-3">üìà</span> Visuals & Stats
                </a>
            </nav>
        </div>
        <div class="p-6 border-t border-gray-100">
            <button onclick="exportAllData()" class="w-full text-xs bg-gray-100 hover:bg-gray-200 text-gray-600 py-2 rounded mb-2">Backup Data (JSON)</button>
            <p class="text-[10px] text-gray-400 text-center">v1.0.0 Production Ready</p>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
        
        <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8">
            <h2 id="page-title" class="text-lg font-semibold text-gray-800">Dashboard</h2>
            <div class="flex items-center space-x-4">
                <span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full">‚óè Local Storage Active</span>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-8" id="content-area">

            <div id="tab-dashboard" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="glass-panel p-6 rounded-xl shadow-sm">
                        <h3 class="text-sm font-medium text-gray-500">Companies Analyzed</h3>
                        <p class="text-3xl font-bold text-gray-900 mt-2" id="stat-count">0</p>
                    </div>
                    <div class="glass-panel p-6 rounded-xl shadow-sm">
                        <h3 class="text-sm font-medium text-gray-500">Total Valuation Tracked</h3>
                        <p class="text-3xl font-bold text-accent-600 mt-2" id="stat-valuation">$0</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center">
                        <h3 class="font-semibold text-gray-800">Recent Reports</h3>
                        <button onclick="showTab('analyze')" class="text-xs bg-corp-900 text-white px-3 py-1.5 rounded hover:bg-gray-800">Add New</button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-gray-50 text-gray-500">
                                <tr>
                                    <th class="px-6 py-3 font-medium">Company</th>
                                    <th class="px-6 py-3 font-medium">CEO</th>
                                    <th class="px-6 py-3 font-medium">Valuation</th>
                                    <th class="px-6 py-3 font-medium">Status</th>
                                    <th class="px-6 py-3 font-medium text-right">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="company-list-body">
                                <tr><td colspan="5" class="text-center py-8 text-gray-400">No data found. Start a new analysis.</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="tab-analyze" class="hide max-w-5xl mx-auto space-y-8">
                
                <div class="glass-panel p-6 rounded-xl border-l-4 border-accent-600">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">üß† PMO Research Assistant</h3>
                    <p class="text-sm text-gray-500 mb-4">Enter a company name to generate deep-search triggers. Use these to find data quickly.</p>
                    <div class="flex gap-2">
                        <input type="text" id="research-input" placeholder="e.g. Google, Zoho, Tesla..." class="flex-1 p-3 border border-gray-300 rounded-lg text-sm">
                        <button onclick="triggerResearch()" class="bg-accent-600 text-white px-6 py-2 rounded-lg hover:bg-accent-500 transition font-medium">Initialize Research</button>
                    </div>
                    <div id="research-links" class="mt-4 flex flex-wrap gap-2 hidden">
                        </div>
                </div>

                <form id="analysis-form" class="space-y-8">
                    <input type="hidden" id="edit-id">
                    
                    <div class="bg-white p-8 rounded-xl shadow-sm border border-gray-200">
                        <h4 class="text-sm uppercase tracking-wide text-gray-500 font-bold mb-6 border-b pb-2">01. Company Profile</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Company Name</label>
                                <input type="text" id="inp-name" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white" required>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">CEO / Leadership</label>
                                <input type="text" id="inp-ceo" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Founders</label>
                                <input type="text" id="inp-founders" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white">
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Current Valuation (Approx)</label>
                                <input type="text" id="inp-valuation" placeholder="e.g. $2B or 500Cr" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white">
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-8 rounded-xl shadow-sm border border-gray-200">
                        <h4 class="text-sm uppercase tracking-wide text-gray-500 font-bold mb-6 border-b pb-2">02. Strategic Analysis</h4>
                        <div class="grid grid-cols-1 gap-6">
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Why this company? (Strategic Relevance)</label>
                                <textarea id="inp-why" rows="3" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white"></textarea>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-xs font-medium text-gray-700 mb-1">Key Products/Services</label>
                                    <textarea id="inp-products" rows="4" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white"></textarea>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-700 mb-1">Target Customers / Market</label>
                                    <textarea id="inp-customers" rows="4" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-8 rounded-xl shadow-sm border border-gray-200">
                        <h4 class="text-sm uppercase tracking-wide text-gray-500 font-bold mb-6 border-b pb-2">03. Market Intelligence</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Their Current Problems/Challenges</label>
                                <textarea id="inp-problems" rows="3" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white"></textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Profit Making Areas (Cash Cows)</label>
                                <textarea id="inp-profit" rows="3" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white"></textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">Upcoming Programs / Future Plans</label>
                                <textarea id="inp-upcoming" rows="3" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white"></textarea>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-gray-700 mb-1">New Opportunities (Gap Analysis)</label>
                                <textarea id="inp-opps" rows="3" class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded focus:bg-white"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end gap-4 pb-10">
                        <button type="button" onclick="resetForm()" class="px-6 py-3 text-sm text-gray-600 hover:text-gray-800">Clear</button>
                        <button type="submit" class="bg-corp-900 text-white px-8 py-3 rounded-lg hover:bg-gray-800 shadow-lg transform active:scale-95 transition">Save Analysis</button>
                    </div>
                </form>
            </div>

            <div id="tab-visualize" class="hide space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="font-bold text-gray-800 mb-4">Comparative Analysis</h3>
                    <div class="h-80 w-full">
                        <canvas id="valuationChart"></canvas>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 class="font-bold text-gray-800 mb-4">Opportunity Matrix</h3>
                        <p class="text-sm text-gray-500 mb-4">Generated based on 'New Opportunities' fields.</p>
                        <ul id="opportunity-list" class="list-disc pl-5 text-sm text-gray-700 space-y-2"></ul>
                    </div>
                </div>
            </div>

        </div>

        <footer class="bg-white border-t border-gray-200 py-3 px-8 text-center">
            <p class="text-[11px] text-gray-400">
                Created for Corporate PMO Use ‚Ä¢ Made with love ‚ù§Ô∏è Harsha Varthan E P
            </p>
        </footer>

    </main>

    <script>
        // State Management
        let companies = JSON.parse(localStorage.getItem('pmo_companies')) || [];
        let currentChart = null;

        // Navigation
        function showTab(tabId) {
            document.querySelectorAll('[id^="tab-"]').forEach(el => el.classList.add('hide'));
            document.getElementById(`tab-${tabId}`).classList.remove('hide');
            
            document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active', 'bg-gray-50', 'text-accent-600', 'border-r-4', 'border-accent-600'));
            const navLink = document.getElementById(`nav-${tabId}`);
            navLink.classList.add('active');

            // Header Update
            const titles = { 'dashboard': 'Command Center', 'analyze': 'Deep Analysis & Documentation', 'visualize': 'Data Visualization' };
            document.getElementById('page-title').innerText = titles[tabId];

            if(tabId === 'dashboard') renderDashboard();
            if(tabId === 'visualize') renderCharts();
        }

        // Research Logic
        function triggerResearch() {
            const query = document.getElementById('research-input').value;
            if(!query) return alert("Please enter a company name.");
            
            const container = document.getElementById('research-links');
            container.innerHTML = '';
            container.classList.remove('hidden');

            const searches = [
                { label: 'üí∞ Valuation', q: `current valuation market cap` },
                { label: 'üë§ CEO/Founders', q: `CEO founders` },
                { label: '‚ö†Ô∏è Problems', q: `challenges business problems complaints` },
                { label: 'üöÄ Future Plans', q: `roadmap future plans upcoming projects` },
                { label: 'üëî LinkedIn', url: `https://www.linkedin.com/search/results/all/?keywords=${encodeURIComponent(query)}` },
                { label: 'üì∞ News', q: `latest news business` }
            ];

            searches.forEach(s => {
                const btn = document.createElement('a');
                btn.className = "text-xs bg-gray-100 hover:bg-accent-100 hover:text-accent-700 text-gray-600 px-3 py-2 rounded border border-gray-200 transition flex items-center gap-1";
                
                let url = s.url ? s.url : `https://www.google.com/search?q=${encodeURIComponent(query + ' ' + s.q)}`;
                
                btn.href = url;
                btn.target = "_blank";
                btn.innerHTML = `${s.label} ‚Üó`;
                container.appendChild(btn);
            });
            
            // Auto-fill name if empty
            if(!document.getElementById('inp-name').value) document.getElementById('inp-name').value = query;
        }

        // Form Handling
        document.getElementById('analysis-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const data = {
                id: document.getElementById('edit-id').value || Date.now().toString(),
                name: document.getElementById('inp-name').value,
                ceo: document.getElementById('inp-ceo').value,
                founders: document.getElementById('inp-founders').value,
                valuation: document.getElementById('inp-valuation').value,
                why: document.getElementById('inp-why').value,
                products: document.getElementById('inp-products').value,
                customers: document.getElementById('inp-customers').value,
                problems: document.getElementById('inp-problems').value,
                profit: document.getElementById('inp-profit').value,
                upcoming: document.getElementById('inp-upcoming').value,
                opps: document.getElementById('inp-opps').value,
                updated: new Date().toLocaleDateString()
            };

            const existingIndex = companies.findIndex(c => c.id === data.id);
            if (existingIndex > -1) {
                companies[existingIndex] = data;
            } else {
                companies.push(data);
            }

            saveData();
            resetForm();
            alert('Analysis Saved Successfully!');
            showTab('dashboard');
        });

        function saveData() {
            localStorage.setItem('pmo_companies', JSON.stringify(companies));
            renderDashboard();
        }

        function resetForm() {
            document.getElementById('analysis-form').reset();
            document.getElementById('edit-id').value = '';
            document.getElementById('research-links').classList.add('hidden');
        }

        // Dashboard Rendering
        function renderDashboard() {
            const tbody = document.getElementById('company-list-body');
            tbody.innerHTML = '';

            // Stats
            document.getElementById('stat-count').innerText = companies.length;
            
            if (companies.length === 0) {
                tbody.innerHTML = `<tr><td colspan="5" class="text-center py-10 text-gray-400">No analyses yet. Head to "New Analysis" to start.</td></tr>`;
                return;
            }

            companies.forEach(c => {
                const tr = document.createElement('tr');
                tr.className = "border-b border-gray-50 hover:bg-gray-50 transition";
                tr.innerHTML = `
                    <td class="px-6 py-4 font-medium text-gray-900">${c.name}</td>
                    <td class="px-6 py-4 text-gray-500">${c.ceo}</td>
                    <td class="px-6 py-4 text-gray-500">${c.valuation}</td>
                    <td class="px-6 py-4"><span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded">Active</span></td>
                    <td class="px-6 py-4 text-right space-x-2">
                        <button onclick="editCompany('${c.id}')" class="text-blue-600 hover:underline text-xs">Edit</button>
                        <button onclick="generatePPT('${c.id}')" class="text-orange-600 hover:underline text-xs">PPT</button>
                        <button onclick="generateWord('${c.id}')" class="text-blue-800 hover:underline text-xs">Word</button>
                        <button onclick="deleteCompany('${c.id}')" class="text-red-400 hover:text-red-600 text-xs">√ó</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function deleteCompany(id) {
            if(confirm('Are you sure?')) {
                companies = companies.filter(c => c.id !== id);
                saveData();
            }
        }

        function editCompany(id) {
            const c = companies.find(c => c.id === id);
            if(!c) return;

            showTab('analyze');
            document.getElementById('edit-id').value = c.id;
            document.getElementById('inp-name').value = c.name;
            document.getElementById('inp-ceo').value = c.ceo;
            document.getElementById('inp-founders').value = c.founders;
            document.getElementById('inp-valuation').value = c.valuation;
            document.getElementById('inp-why').value = c.why;
            document.getElementById('inp-products').value = c.products;
            document.getElementById('inp-customers').value = c.customers;
            document.getElementById('inp-problems').value = c.problems;
            document.getElementById('inp-profit').value = c.profit;
            document.getElementById('inp-upcoming').value = c.upcoming;
            document.getElementById('inp-opps').value = c.opps;
            document.getElementById('research-input').value = c.name;
        }

        // Charts
        function renderCharts() {
            const ctx = document.getElementById('valuationChart').getContext('2d');
            const labels = companies.map(c => c.name);
            // Simple parse for chart demo (removes non-digits) - in production needs better parsing
            const data = companies.map(c => {
                const num = parseFloat(c.valuation.replace(/[^0-9.]/g, ''));
                return isNaN(num) ? 0 : num;
            });

            if (currentChart) currentChart.destroy();

            currentChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Valuation Estimate (Numeric Value extracted)',
                        data: data,
                        backgroundColor: '#1e293b',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true } }
                }
            });

            // Opportunity List
            const list = document.getElementById('opportunity-list');
            list.innerHTML = '';
            companies.forEach(c => {
                if(c.opps) {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>${c.name}:</strong> ${c.opps.substring(0, 100)}...`;
                    list.appendChild(li);
                }
            });
        }

        // EXPORT LOGIC: PPT
        function generatePPT(id) {
            const c = companies.find(c => c.id === id);
            let pptx = new PptxGenJS();
            
            // Slide 1: Title
            let slide1 = pptx.addSlide();
            slide1.background = { color: "1e293b" };
            slide1.addText("Corporate Analysis Report", { x: 0.5, y: 2, w: '90%', fontSize: 18, color: "cbd5e1" });
            slide1.addText(c.name, { x: 0.5, y: 3, w: '90%', fontSize: 48, bold: true, color: "ffffff" });
            slide1.addText(`Prepared by PMO | Date: ${c.updated}`, { x: 0.5, y: 5, fontSize: 12, color: "94a3b8" });

            // Slide 2: Overview
            let slide2 = pptx.addSlide();
            slide2.addText(`Executive Summary: ${c.name}`, { x: 0.5, y: 0.5, fontSize: 24, bold: true, color: "1e293b" });
            
            const dataTable = [
                [{ text: "Category", options: { bold: true, fill: "f1f5f9" } }, { text: "Details", options: { bold: true, fill: "f1f5f9" } }],
                ["CEO", c.ceo],
                ["Founders", c.founders],
                ["Valuation", c.valuation],
                ["Strategic Relevance", c.why]
            ];
            slide2.addTable(dataTable, { x: 0.5, y: 1.5, w: 9, color: "333333", border: { pt: 1, color: "e2e8f0" } });

            // Slide 3: Deep Dive
            let slide3 = pptx.addSlide();
            slide3.addText("Market Intelligence", { x: 0.5, y: 0.5, fontSize: 24, bold: true, color: "1e293b" });
            
            slide3.addText("Key Problems:", { x: 0.5, y: 1.5, fontSize: 14, bold: true, color: "ef4444" });
            slide3.addText(c.problems, { x: 0.5, y: 1.8, w: 9, h: 1.5, fontSize: 12, color: "333333", shape: pptx.ShapeType.rect, fill: "fef2f2" });

            slide3.addText("New Opportunities:", { x: 0.5, y: 3.5, fontSize: 14, bold: true, color: "22c55e" });
            slide3.addText(c.opps, { x: 0.5, y: 3.8, w: 9, h: 1.5, fontSize: 12, color: "333333", shape: pptx.ShapeType.rect, fill: "f0fdf4" });

            pptx.writeFile({ fileName: `${c.name}_Analysis.pptx` });
        }

        // EXPORT LOGIC: WORD
        function generateWord(id) {
            const c = companies.find(c => c.id === id);
            
            const content = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset='utf-8'><title>Report</title></head>
                <body style="font-family: Arial, sans-serif; line-height: 1.6;">
                    <h1 style="color: #1e293b; border-bottom: 2px solid #3b82f6; padding-bottom: 10px;">${c.name} - Corporate Analysis</h1>
                    <p><strong>Date:</strong> ${c.updated}</p>
                    <p><strong>Analyst:</strong> Harsha Varthan E P</p>
                    
                    <h2 style="background: #f1f5f9; padding: 10px;">Executive Summary</h2>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                        <tr><td style="padding: 8px; border: 1px solid #ddd; width: 30%;"><strong>CEO</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${c.ceo}</td></tr>
                        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Founders</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${c.founders}</td></tr>
                        <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>Valuation</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${c.valuation}</td></tr>
                    </table>

                    <h3>Strategic Relevance</h3>
                    <p>${c.why}</p>

                    <h3>Market Analysis</h3>
                    <ul>
                        <li><strong>Products:</strong> ${c.products}</li>
                        <li><strong>Customers:</strong> ${c.customers}</li>
                        <li><strong>Profit Areas:</strong> ${c.profit}</li>
                    </ul>

                    <h3 style="color: #b91c1c;">Challenges</h3>
                    <p>${c.problems}</p>

                    <h3 style="color: #15803d;">Opportunities</h3>
                    <p>${c.opps}</p>
                    
                    <hr>
                    <p style="text-align: center; font-size: 10px; color: #888;">Generated by PMO Analyzer</p>
                </body>
                </html>
            `;

            const blob = new Blob(['\ufeff', content], {
                type: 'application/msword'
            });
            saveAs(blob, `${c.name}_Report.doc`);
        }
        
        // Backup
        function exportAllData() {
            const blob = new Blob([JSON.stringify(companies, null, 2)], {type: "application/json"});
            saveAs(blob, "pmo_backup.json");
        }

        // Init
        showTab('dashboard');
    </script>
</body>
</html>
